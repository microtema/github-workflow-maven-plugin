build:
  name: Build
  runs-on: [ %RUNS_ON% ]
  needs: [ %NEEDS% ]
  steps:
    - name: 'Checkout'
      uses: actions/checkout@v2
    - name: 'Java: Setup'
      uses: actions/setup-java@v2
      with:
        distribution: 'adopt'
        java-version: ${{ env.JAVA_VERSION }}
    - name: 'Artifact: download'
      if: %POM_ARTIFACT%
      uses: actions/download-artifact@v2
      with:
        name: pom-artifact
    - name: 'Maven: package'
      run: mvn package -P prod -Dcode.coverage=0.0 -DskipTests=true $MAVEN_CLI_OPTS
    - name: 'Artifact: prepare'
      run: |
        mkdir -p artifact/target
        mv target artifact/target
    - name: 'Artifact: upload'
      uses: actions/upload-artifact@v2
      with:
        name: target-artifact
        path: artifact/target
