quality-gate:
  name: Quality Gate
  runs-on: [ %RUNS_ON% ]
  needs: [ %NEEDS% ]
  steps:
    - name: 'Checkout'
      uses: actions/checkout@v2
    - name: 'Java: Setup'
      uses: actions/setup-java@v1
      with:
        java-version: ${{ env.JAVA_VERSION }}
    - name: 'Artifact: download'
      uses: actions/download-artifact@v2
      with:
        name: target_artifact
    - name: 'Maven: sonar'
      run: |
        mvn verify -DskipTests=true -DskipITs=true -DskipUTs=true $MAVEN_CLI_OPTS
        mvn sonar:sonar -Dsonar.login=$SONAR_TOKEN $MAVEN_CLI_OPTS
